service: ${env:SERVICE_NAME,"imageScaler"}

useDotenv: true
configValidationMode: error

provider:
  name: aws
  # The AWS region in which to deploy (us-east-1 is the default)
  region: ${env:AWS_REGION}
  # The stage of the application, e.g. dev, production, stagingâ€¦
  stage: ${opt:stage,"development"}
  iam:
    role: ${env:SERVERLESS_ROLE}
  runtime: nodejs16.x
  versionFunctions: false
  deploymentBucket:
    name: ${env:DEPLOYMENT_BUCKET}
  environment:
    BUCKET: ${env:BUCKET}
    BUCKET_URL: ${env:BUCKET_URL}
    SCALED_FOLDER: ${env:SCALED_FOLDER}
    IMAGE_ACL: ${env:IMAGE_ACL,""}
    IMAGE_QUALITY: ${env:IMAGE_QUALITY,80}

functions:
  main:
    handler: index.handler
    description: "Scale images at runtime."
    events:
      - http:
          path: resize
          method: get
